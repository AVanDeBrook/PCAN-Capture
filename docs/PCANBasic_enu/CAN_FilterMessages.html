<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>CAN_FilterMessages</title>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="33%">
<div class="Element1">
PCAN-Basic Documentation</div>
</td><td width="34%">
<div class="Element2">
<a href="index.html"><img src="btn_globals_home_black.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_black_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_black.gif');"></a></div>
</td><td width="33%">
<div class="Element90">
<a href="CAN_SetValue.html"><img src="btn_prev_black.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_black_hover.gif');" onmouseout="switchImage(this, 'btn_prev_black.gif');"></a><a href="Functions.html"><img src="btn_up_black.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_black_hover.gif');" onmouseout="switchImage(this, 'btn_up_black.gif');"></a><a href="CAN_GetErrorText.html"><img src="btn_next_black.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_black_hover.gif');" onmouseout="switchImage(this, 'btn_next_black.gif');"></a></div>
</td></tr></table><div class="Element5">
CAN_FilterMessages</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="53756D6D617279"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Configures the reception filter.</p></div>
</div>
<a name="53796E746178"></a><div class="Element14">
Syntax</div>
<div class="Element11">
<div class="Element10">
</div>
</div>
<a name="432B2B"></a><div class="Element99">
<a onclick="toggleVisibilityStored('432B2B');" class="a_Element99"><img src="btn_collapse_2.gif" border="0" alt="" title="" id="img432B2B">C++</a></div>
<div id="div432B2B">
<div class="Element101"><div class="Element100"><pre class="Element100"><span style="color: #0000FF"><a href="TPCANStatus.html">TPCANStatus</a></span><span style="color: #00008A"> </span><span style="color: #871F78">__stdcall</span><span style="color: #00008A"> </span>CAN_FilterMessages<span style="color: #00008A">(</span>
<span style="color: #00008A">        </span><span style="color: #0000FF"><a href="TPCANHandle.html">TPCANHandle</a></span><span style="color: #00008A"> Channel,</span>
<span style="color: #00008A">        </span><span style="color: #0000FF">DWORD</span><span style="color: #00008A"> FromID,</span>
<span style="color: #00008A">        </span><span style="color: #0000FF">DWORD</span><span style="color: #00008A"> ToID,</span>
<span style="color: #00008A">        </span><span style="color: #0000FF"><a href="TPCANMode.html">TPCANMode</a></span><span style="color: #00008A"> Mode</span>
<span style="color: #00008A">);</span></pre></div></div>
</div>
<a name="506172616D6574657273"></a><div class="Element14">
<a onclick="toggleVisibilityStored('506172616D6574657273');" class="a_Element14"><img src="btn_collapse_2.gif" border="0" alt="" title="" id="img506172616D6574657273">Parameters</a></div>
<div id="div506172616D6574657273">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table3">
<tr>
<td class="Element240" valign="top" width="50%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="50%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="50%">
<div class="Element243">
Channel&nbsp;</div></td><td class="Element246" valign="top" width="50%">
<div class="Element247">
The handle of a PCAN Channel (see <a href="TPCANHandle.html">TPCANHandle</a>).&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="50%">
<div class="Element243">
FromID&nbsp;</div></td><td class="Element246" valign="top" width="50%">
<div class="Element247">
The lowest CAN ID wanted to be received.&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="50%">
<div class="Element243">
ToID&nbsp;</div></td><td class="Element246" valign="top" width="50%">
<div class="Element247">
The highest CAN ID wanted to be received.&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="50%">
<div class="Element243">
Mode&nbsp;</div></td><td class="Element246" valign="top" width="50%">
<div class="Element247">
The type of the filter being set (see <a href="TPCANType.html">TPCANType</a>).&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
<a onclick="toggleVisibilityStored('52657475726E73');" class="a_Element14"><img src="btn_collapse_2.gif" border="0" alt="" title="" id="img52657475726E73">Returns</a></div>
<div id="div52657475726E73">
<div class="Element11">
<div class="Element10">
<p class="Element10">
The return value is a <a href="TPCANStatus.html">TPCANStatus</a> code. PCAN_ERROR_OK is returned on success. The typical errors in case of failure are: </p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table4">
<tr>
<td class="Element67" valign="top" width="20%" style="border:none;">
<div class="Element68">
<strong>PCAN_ERROR_INITIALIZE:</strong>&nbsp;</div></td><td class="Element67" valign="top" width="80%" style="border:none;">
<div class="Element68">
Indicates that the given PCAN channel was not found in the list of initialized channels of the calling application.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="52656D61726B73"></a><div class="Element14">
<a onclick="toggleVisibilityStored('52656D61726B73');" class="a_Element14"><img src="btn_collapse_2.gif" border="0" alt="" title="" id="img52656D61726B73">Remarks</a></div>
<div id="div52656D61726B73">
<div class="Element11">
<div class="Element10">
<p class="Element10">
Note that after a PCAN Channel is initialized, the status of its filter is fully opened. According with the current filter status, calling this function causes the following behavior:</p>
<ul class="Element630">
<li class="Element600">Filter status is PCAN_FILTER_OPEN: The filter is automatically closed and then configured with the given range of IDs passed to this function [FromID, ToID] .</li>
<li class="Element600">Filter status is PCAN_FILTER_CLOSE: The filter is set to the given range of IDs passed to this function [FromID, ToID] .</li>
<li class="Element600">Filter status is PCAN_FILTER_CUSTOM: The filter is expanded with the given range of Ids [FromID, ToID]. If a smaller or different range is required than a range that has been configured before, the filter has to be closed first before calling the CAN_FilterMessages function. To do this use the function <a href="CAN_SetValue.html">CAN_SetValue</a>.</li>
</ul><p class="Element10">
The parameter '<i>Mode</i>' indicates which kind of ID is being used to register the new filter range. There are two possible values, Standard (11-bit identifier) or Extended (29-bit identifier). Standard frames are using the bit positions 28 to 18 of the Acceptance Mask/Code registers in the SJA1000 CAN controller. Drivers for 82C200 CAN controllers have to shift the bits down to positions 10 to 0.&nbsp;</p>
<p class="Element10">
Take in account that configuring the message filter cause the CAN controller to enter the <a href="Reset.html">Reset</a> state. This will affect other applications that communicate with the same PCAN hardware.&nbsp;</p>
<p class="Element10">
<strong>Notes:</strong>&nbsp;</p>
<ol class="Element630">
<li value="1" class="Element600">There is only one filter for standard and extended CAN messages. It seems that the ID from a standard message uses the most significant 11 bits (bit 18 to 28) of the 29 bits. I.e. the standard ID 400h is also received by indicating an extended ID 10000000h. For this reason it is <u>not recommended</u> to mix standard and extended filters, since it can increase the risk of receiving unwanted messages.</li>
<li value="2" class="Element600">Multiple calls of <strong>CAN_FilterMessages</strong> expand the reception filter.</li>
<li value="3" class="Element600">It is not guaranteed that an application only receives CAN messages in the range of <strong>FromID</strong> to <strong>ToID</strong>. This is caused by the operating principle of the SJA1000's acceptance filter. See also Philips Data Sheet &quot;SJA1000 Stand-alone CAN-controller&quot;.</li>
</ol></div>
</div>
</div>
<a name="4578616D706C65"></a><div class="Element14">
<a onclick="toggleVisibilityStored('4578616D706C65');" class="a_Element14"><img src="btn_collapse_2.gif" border="0" alt="" title="" id="img4578616D706C65">Example</a></div>
<div id="div4578616D706C65">
<div class="Element11">
<div class="Element10">
<p class="Element10">
The following example shows the use of CAN_FilterMessages on the channel PCAN_USBBUS1 to receive a custom range of IDs. In case of failure, the returned code will be translated to a text (according with the operating system language) in English, German, Italian, French or Spanish, and it will be shown to the user.&nbsp;</p>
<p class="Element10">
Note: It is assumed that the channel was already initialized.&nbsp;</p>
<p class="Element10">
<strong>C++:</strong> &nbsp;</p><div class="Element13"><div class="Element12"><pre class="Element12">
<span style="color: #0000FF"><a href="TPCANStatus.html">TPCANStatus</a></span><span style="color: #00008A"> result;</span>
<span style="color: #0000FF">char</span><span style="color: #00008A"> strMsg[256];</span>
<span style="color: #0000FF">DWORD iBuffer;</span>

<span style="color: #008000">// The message filter is closed first to ensure the reception of the new range of IDs.</span>
<span style="color: #008000">//</span>
<span style="color: #00008A">iBuffer = </span><span style="color: #0000FF">PCAN_FILTER_CLOSE</span><span style="color: #00008A">;</span>
<span style="color: #00008A">result = </span><a href="CAN_SetValue.html">CAN_SetValue</a><span style="color: #00008A">(</span><span style="color: #0000FF">PCAN_USBBUS1,PCAN_MESSAGE_FILTER,&amp;</span><span style="color: #00008A">iBuffer, </span><span style="color: #871F78">sizeof</span><span style="color: #00008A">(iBuffer)</span><span style="color: #0000FF">);</span>

<span style="color: #871F78">if</span><span style="color: #00008A">(result != </span><span style="color: #0000FF">PCAN_ERROR_OK</span><span style="color: #00008A">)</span>
<span style="color: #00008A">{</span>
<span style="color: #008000">    // An error occurred, get a text describing the error and show it</span>
<span style="color: #008000">    //</span>
<span style="color: #00008A">    </span><a href="CAN_GetErrorText.html">CAN_GetErrorText</a><span style="color: #00008A">(result, 0, strMsg);</span>
<span style="color: #00008A">    MessageBox(strMsg);</span>
<span style="color: #00008A">}</span>
<span style="color: #871F78">else</span>
<span style="color: #00008A">{</span>
<span style="color: #008000">    // The message filter is configured to receive the IDs 2,3,4 and 5 on the PCAN-USB, Channel 1</span>
<span style="color: #008000">    //</span>
<span style="color: #00008A">    result = </span>CAN_FilterMessages<span style="color: #00008A">(</span><span style="color: #0000FF">PCAN_USBBUS1, 2, 5, PCAN_MESSAGE_STANDARD</span><span style="color: #00008A">);</span>
<span style="color: #871F78">    if</span><span style="color: #00008A">(result != </span><span style="color: #0000FF">PCAN_ERROR_OK</span><span style="color: #00008A">)</span>
<span style="color: #00008A">    {</span>
<span style="color: #008000">        // An error occurred, get a text describing the error and show it</span>
<span style="color: #008000">        //</span>
<span style="color: #00008A">        </span><a href="CAN_GetErrorText.html">CAN_GetErrorText</a><span style="color: #00008A">(result, 0, strMsg);</span>
<span style="color: #00008A">        MessageBox(strMsg);</span>
<span style="color: #00008A">    }</span>
<span style="color: #871F78">    else</span>
<span style="color: #00008A">        MessageBox(</span><span style="color: #A31515">&quot;Filter successfully configured for IDs 2,3,4 and 5&quot;</span><span style="color: #00008A">);</span>
<span style="color: #00008A">}</span>
</pre></div></div>
</div>
</div>
</div>
<a name="53656520416C736F"></a><div class="Element14">
<a onclick="toggleVisibilityStored('53656520416C736F');" class="a_Element14"><img src="btn_collapse_2.gif" border="0" alt="" title="" id="img53656520416C736F">See Also</a></div>
<div id="div53656520416C736F">
<div class="Element11">
<div class="Element10">
<p class="Element10">
<a href="CAN_SetValue.html">CAN_SetValue</a>&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>Class-method Version</strong>: <a href="FilterMessages.html">FilterMessages</a></p></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 2019. PEAK-System Technik GmbH. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Send <a href="#" onclick="sendFeedback('support@peak-system.com', 'PCAN-Basic Documentation Feedback', 'Project: PCAN-Basic Documentation%0ATopic ID: CAN_FilterMessages');"> feedback </a> to this documentation</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>